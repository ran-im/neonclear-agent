<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neon Clear - Transparency Agent</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
      background: 
        radial-gradient(ellipse at 20% 80%, rgba(0, 255, 136, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 20%, rgba(0, 212, 255, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(88, 28, 135, 0.15) 0%, transparent 70%),
        linear-gradient(180deg, #0d0d12 0%, #13131a 50%, #0a0a0f 100%);
      min-height: 100vh;
      color: #c8d4e0;
      position: relative;
      overflow-x: hidden;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(0, 255, 136, 0.03) 1px, transparent 1px),
        radial-gradient(circle at 90% 80%, rgba(0, 212, 255, 0.03) 1px, transparent 1px),
        radial-gradient(circle at 50% 10%, rgba(168, 85, 247, 0.03) 1px, transparent 1px);
      background-size: 60px 60px, 80px 80px, 100px 100px;
      pointer-events: none;
      z-index: 0;
    }
    body::after {
      content: '{ }';
      position: fixed;
      bottom: 20px;
      right: 30px;
      font-size: 120px;
      opacity: 0.03;
      font-weight: bold;
      pointer-events: none;
      z-index: 0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      position: relative;
      z-index: 1;
    }
    header {
      text-align: center;
      margin-bottom: 2rem;
    }
    h1 {
      font-size: 3rem;
      font-weight: 700;
      letter-spacing: -1px;
      background: linear-gradient(135deg, #00ff88 0%, #00d4ff 50%, #a855f7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 40px rgba(0, 255, 136, 0.3);
    }
    .subtitle {
      font-size: 0.9rem;
      color: #6b7280;
      letter-spacing: 2px;
      text-transform: uppercase;
    }
    .badge {
      display: inline-block;
      background: rgba(0, 255, 136, 0.08);
      border: 1px solid rgba(0, 255, 136, 0.3);
      color: #00ff88;
      padding: 0.4rem 1rem;
      border-radius: 2rem;
      font-size: 0.7rem;
      margin-top: 1rem;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    .setup-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 1.5rem;
      backdrop-filter: blur(10px);
    }
    .setup-card h2 {
      font-size: 1.1rem;
      color: #00ff88;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .setup-card h2::before {
      content: '>';
      color: #00ff88;
    }
    .api-key-input {
      display: flex;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .api-key-input input {
      flex: 1;
      padding: 0.875rem 1rem;
      border: 1px solid rgba(0, 255, 136, 0.2);
      border-radius: 0.5rem;
      background: rgba(0, 0, 0, 0.4);
      color: #e0e0e0;
      font-size: 0.9rem;
      font-family: inherit;
      transition: all 0.3s ease;
    }
    .api-key-input input:focus {
      outline: none;
      border-color: #00ff88;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.1);
    }
    .api-key-input input::placeholder {
      color: #4b5563;
    }
    .api-key-input button {
      padding: 0.875rem 1.5rem;
      background: linear-gradient(135deg, #00ff88, #00d4ff);
      border: none;
      border-radius: 0.5rem;
      color: #0a0a0f;
      font-weight: 700;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .api-key-input button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
    }
    .hint {
      font-size: 0.75rem;
      color: #4b5563;
    }
    .hint a {
      color: #00d4ff;
      text-decoration: none;
    }
    .chat-container {
      background: rgba(255, 255, 255, 0.015);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 1rem;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }
    .messages {
      height: 450px;
      overflow-y: auto;
      padding: 1.5rem;
      scroll-behavior: smooth;
    }
    .messages::-webkit-scrollbar {
      width: 6px;
    }
    .messages::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.02);
    }
    .messages::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 136, 0.2);
      border-radius: 3px;
    }
    .message {
      margin-bottom: 1.25rem;
      padding: 1rem 1.25rem;
      border-radius: 0.75rem;
      line-height: 1.6;
      font-size: 0.95rem;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .message.user {
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 212, 255, 0.05) 100%);
      border-left: 3px solid #00d4ff;
      margin-left: 2rem;
      color: #e0e0e0;
    }
    .message.assistant {
      background: linear-gradient(135deg, rgba(0, 255, 136, 0.08) 0%, rgba(0, 255, 136, 0.02) 100%);
      border-left: 3px solid #00ff88;
      margin-right: 2rem;
      color: #c8d4e0;
    }
    .message.handover {
      background: linear-gradient(135deg, rgba(255, 68, 68, 0.1) 0%, rgba(255, 68, 68, 0.05) 100%);
      border-left: 3px solid #ff4444;
    }
    .ai-disclosure {
      background: rgba(168, 85, 247, 0.1);
      border: 1px solid rgba(168, 85, 247, 0.3);
      color: #a855f7;
      padding: 0.6rem;
      border-radius: 0.5rem;
      font-size: 0.8rem;
      margin-bottom: 0.75rem;
      text-align: center;
      font-weight: 500;
    }
    .input-area {
      display: flex;
      gap: 0.75rem;
      padding: 1rem 1.25rem;
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      background: rgba(0, 0, 0, 0.2);
    }
    #userInput {
      flex: 1;
      padding: 0.875rem 1rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 0.5rem;
      background: rgba(0, 0, 0, 0.4);
      color: #e0e0e0;
      font-size: 0.95rem;
      font-family: inherit;
      transition: all 0.3s ease;
    }
    #userInput:focus {
      outline: none;
      border-color: #00ff88;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.1);
    }
    #userInput::placeholder {
      color: #4b5563;
    }
    #sendBtn {
      padding: 0.875rem 1.5rem;
      background: linear-gradient(135deg, #00ff88, #00d4ff);
      border: none;
      border-radius: 0.5rem;
      color: #0a0a0f;
      font-weight: 700;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    #sendBtn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
    }
    #sendBtn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .typing {
      color: #00ff88;
      font-style: italic;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .hidden {
      display: none !important;
    }
    .doodle {
      position: fixed;
      font-size: 2rem;
      opacity: 0.04;
      pointer-events: none;
      z-index: 0;
    }
    .doodle-1 { top: 10%; left: 5%; transform: rotate(-15deg); }
    .doodle-2 { bottom: 15%; right: 8%; transform: rotate(10deg); }
    .doodle-3 { top: 60%; left: 3%; transform: rotate(5deg); }
  </style>
</head>
<body>
  <!-- Decorative doodles -->
  <div class="doodle doodle-1">âŒ˜</div>
  <div class="doodle doodle-2">âš¡</div>
  <div class="doodle doodle-3">â—ˆ</div>

  <div class="container">
    <header>
      <h1>Neon Clear</h1>
      <p class="subtitle">// Transparency Advocate</p>
      <span class="badge">Trust Through Radical Honesty</span>
    </header>

    <!-- API Key Setup -->
    <div class="setup-card" id="setupCard">
      <h2>Connect Your API Key</h2>
      <div class="api-key-input">
        <input type="password" id="apiKey" placeholder="sk-ant-..." />
        <button id="connectBtn">Connect</button>
      </div>
      <p class="hint">Get your key from <a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a></p>
      <p class="hint" style="margin-top: 0.5rem;"><a href="#" onclick="resetApiKey(); return false;">Reset API Key</a></p>
      <div id="apiStatus" style="margin-top: 1rem; padding: 0.75rem; border-radius: 0.5rem; display: none;"></div>
    </div>

    <!-- Chat Interface -->
    <div class="chat-container hidden" id="chatContainer">
      <div class="messages" id="messages"></div>
      <div class="input-area">
        <input type="text" id="userInput" placeholder="Ask about lag, data privacy, or game recommendations..." />
        <button id="sendBtn" onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <script>
    const SYSTEM_PROMPT = `IDENTITY & PERSONALITY:
You are Neon Clear, the Lead Transparency & Trust Advocate for Neon Arcade. Your primary mission is to rebuild player confidence in our cloud gaming platform following a period of declining session times. You are professional, radically honest, and reassuring. You avoid "corporate speak" in favor of clear, plain language that respects the player's intelligence.

DOMAIN EXPERTISE:
- Cloud Gaming Infrastructure: Expert knowledge of how server latency, packet loss, and bandwidth affect gameplay.
- Regulatory Compliance: Deep understanding of the EU AI Act (transparency obligations) and GDPR (specifically Art. 13-15 regarding Data Subject Rights).
- Algorithmic Logic: Specialized in explaining how Recommender Systems function without exposing proprietary source code.

COMMUNICATION STYLE:
- The "Why" First: Always lead with the reasoning behind an action or recommendation.
- Plain Language: Translate complex technical or legal terms into "gamer-friendly" explanations.
- Proactive Disclosure: If the platform is experiencing high server load, admit it immediately rather than letting the user guess.

CONSTRAINTS (What You Will & Will NOT Do):
- WILL NOT share personally identifiable information (PII) of other users.
- WILL NOT guarantee 0ms latency; you must be honest about technical limitations.
- WILL disclose that you are an AI assistant in your very first interaction.
- WILL offer a "Human Escalate" option if the user expresses a lack of trust in your explanation (GDPR Art. 22 compliance).

SPECIFIC INSTRUCTIONS FOR TRUST & TRANSPARENCY:
1. Algorithmic Explanation: When a user asks about game suggestions (addressing the issue where 65% of players only play one game), explain that the suggestion is based on their playtime patterns and current network stability, not on third-party data buying.

2. Performance Transparency: If a user mentions session drops or lag, provide a "Network Health Summary" instead of a generic troubleshooting list.

3. Data Rights Support: If a user asks about their data, explain their right to access and delete it as per Neon Arcade's GDPR commitment.

GDPR DATA PRIVACY FOOTER (include at end of EVERY response):
---
ðŸ”’ Your Data Rights (GDPR Art. 13-15):
â€¢ Right to Access: You can request a copy of all data we hold about you
â€¢ Right to Deletion: You can request we delete your data entirely
â€¢ Right to Explanation: You can ask how any AI recommendation was made about you
â€¢ Contact: privacy@neonarcade.com | neonarcade.com/privacy
---

HUMAN ESCALATION:
If user expresses lack of trust or dissatisfaction, immediately offer: "[HUMAN ESCALATION: A trust specialist will review your case within 24 hours. Contact: trust@neonarcade.com]"`;

    const HANDOVER_TRIGGERS = ['unauthorized charge', 'privacy violation', 'data breach', 'illegal activity', 'not trust', "don't trust", 'unhappy', 'speak to human', 'speak to a person', 'human escalation', 'complaint'];
    let apiKey = localStorage.getItem('neonclear_api_key') || '';
    let messages = [];

    const AI_DISCLOSURE = "ðŸ¤– I'm Neon Clear, an AI Transparency Advocate for Neon Arcade. I'm here to help explain our systems, protect your data rights, and improve your gaming experience through radical honesty. EU AI Act Art. 50 Compliant.";

    function resetApiKey() {
      localStorage.removeItem('neonclear_api_key');
      apiKey = '';
      messages = [];
      document.getElementById('setupCard').classList.remove('hidden');
      document.getElementById('chatContainer').classList.add('hidden');
      document.getElementById('messages').innerHTML = '';
      document.getElementById('apiStatus').style.display = 'none';
    }

    async function testAndSaveApiKey() {
      const input = document.getElementById('apiKey').value.trim();
      const statusDiv = document.getElementById('apiStatus');
      
      if (!input) {
        alert('Please enter an API key');
        return;
      }
      
      statusDiv.style.display = 'block';
      statusDiv.style.background = 'rgba(255,193,7,0.1)';
      statusDiv.style.border = '1px solid #ffc107';
      statusDiv.style.color = '#ffc107';
      statusDiv.innerHTML = 'Testing API key...';
      
      try {
        // Use CORS proxy to bypass browser restrictions
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const apiUrl = 'https://api.anthropic.com/v1/messages';
        
        const response = await fetch(proxyUrl + encodeURIComponent(apiUrl), {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': input,
            'anthropic-version': '2023-06-01'
          },
          body: JSON.stringify({
            model: 'claude-sonnet-4-6',
            max_tokens: 10,
            messages: [{ role: 'user', content: 'hi' }]
          })
        });
        
        const data = await response.json();
        
        if (data.content || response.status === 200) {
          statusDiv.style.background = 'rgba(0,255,136,0.1)';
          statusDiv.style.border = '1px solid #00ff88';
          statusDiv.style.color = '#00ff88';
          statusDiv.innerHTML = 'âœ“ API key works! Connecting...';
          apiKey = input;
          localStorage.setItem('neonclear_api_key', apiKey);
          setTimeout(() => {
            document.getElementById('setupCard').classList.add('hidden');
            document.getElementById('chatContainer').classList.remove('hidden');
            addMessage(AI_DISCLOSURE + "\n\nHow can I help you today?", 'assistant');
          }, 1000);
        } else if (data.error) {
          statusDiv.style.background = 'rgba(255,68,68,0.1)';
          statusDiv.style.border = '1px solid #ff4444';
          statusDiv.style.color = '#ff4444';
          statusDiv.innerHTML = 'âœ— Error: ' + data.error.message;
        }
      } catch (error) {
        statusDiv.style.background = 'rgba(255,68,68,0.1)';
        statusDiv.style.border = '1px solid #ff4444';
        statusDiv.style.color = '#ff4444';
        statusDiv.innerHTML = 'âœ— Connection error: ' + error.message;
      }
    }

    if (apiKey && apiKey.startsWith('sk-ant-') && apiKey.length > 20) {
      document.getElementById('setupCard').classList.add('hidden');
      document.getElementById('chatContainer').classList.remove('hidden');
      addMessage(AI_DISCLOSURE + "\n\nHow can I help you today?", 'assistant');
    } else {
      // Clear invalid stored key
      localStorage.removeItem('neonclear_api_key');
      apiKey = '';
    }

    const messagesDiv = document.getElementById('messages');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    function addMessage(content, role, isHandover = false) {
      const div = document.createElement('div');
      div.className = `message ${role}${isHandover ? ' handover' : ''}`;
      
      if (role === 'assistant') {
        if (messages.filter(m => m.role === 'assistant').length === 0) {
          const disclosure = document.createElement('div');
          disclosure.className = 'ai-disclosure';
          disclosure.textContent = AI_DISCLOSURE;
          div.appendChild(disclosure);
        }
      }
      
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = content.replace(/\n/g, '<br>');
      div.appendChild(contentDiv);
      
      messagesDiv.appendChild(div);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message) return;

      if (!apiKey) {
        alert('Please enter your API key first!');
        return;
      }

      userInput.value = '';
      addMessage(message, 'user');
      
      sendBtn.disabled = true;
      addMessage('Processing...', 'assistant');

      const shouldHandover = HANDOVER_TRIGGERS.some(trigger => 
        message.toLowerCase().includes(trigger.toLowerCase())
      );

      if (shouldHandover) {
        messagesDiv.removeChild(messagesDiv.lastChild);
        addMessage(`[HUMAN ESCALATION: A trust specialist will review your case within 24 hours. Contact: trust@neonarcade.com]

ðŸ”’ Your Data Rights (GDPR):
â€¢ Right to Access: Request your data
â€¢ Right to Deletion: Request deletion
â€¢ Contact: privacy@neonarcade.com`, 'assistant', true);
        sendBtn.disabled = false;
        return;
      }

      try {
        // Use CORS proxy to bypass browser restrictions
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const apiUrl = 'https://api.anthropic.com/v1/messages';
        
        const response = await fetch(proxyUrl + encodeURIComponent(apiUrl), {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': apiKey,
            'anthropic-version': '2023-06-01'
          },
          body: JSON.stringify({
            model: 'claude-sonnet-4-6',
            max_tokens: 1024,
            system: SYSTEM_PROMPT,
            messages: messages.concat([{ role: 'user', content: message }])
          })
        });

        const data = await response.json();
        
        messagesDiv.removeChild(messagesDiv.lastChild);
        
        if (data.content && data.content[0]) {
          const responseText = data.content[0].text;
          messages.push({ role: 'user', content: message });
          messages.push({ role: 'assistant', content: responseText });
          addMessage(responseText, 'assistant');
        } else if (data.error) {
          addMessage(`API Error: ${data.error.message}\n\nType: ${data.error.type || 'unknown'}`, 'assistant');
        } else {
          addMessage('Response: ' + JSON.stringify(data), 'assistant');
        }
      } catch (error) {
        messagesDiv.removeChild(messagesDiv.lastChild);
        addMessage(`Error: ${error.message}\n\nThis might be a CORS issue. Try opening the console (F12) for more details.`, 'assistant');
      }

      sendBtn.disabled = false;
    }

    // Add event listeners
    document.addEventListener('DOMContentLoaded', function() {
      const connectBtn = document.getElementById('connectBtn');
      const apiKeyInput = document.getElementById('apiKey');
      
      if (connectBtn) {
        connectBtn.addEventListener('click', testAndSaveApiKey);
      }
      if (apiKeyInput) {
        apiKeyInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            testAndSaveApiKey();
          }
        });
      }
    });
  </script>
</body>
</html>
