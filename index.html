<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neon Clear - Transparency Agent</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%);
      min-height: 100vh;
      color: #e0e0e0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
    }
    header {
      text-align: center;
      margin-bottom: 2rem;
    }
    h1 {
      font-size: 2.5rem;
      background: linear-gradient(90deg, #00ff88, #00d4ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
    }
    .badge {
      display: inline-block;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      color: #00ff88;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
    }
    .setup-warning {
      background: rgba(255, 193, 7, 0.1);
      border: 1px solid #ffc107;
      color: #ffc107;
      padding: 1rem;
      border-radius: 0.75rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    .chat-container {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      overflow: hidden;
    }
    .messages {
      height: 400px;
      overflow-y: auto;
      padding: 1.5rem;
    }
    .message {
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: 0.75rem;
      line-height: 1.5;
    }
    .message.user {
      background: rgba(0, 212, 255, 0.1);
      border-left: 3px solid #00d4ff;
      margin-left: 2rem;
    }
    .message.assistant {
      background: rgba(0, 255, 136, 0.05);
      border-left: 3px solid #00ff88;
      margin-right: 2rem;
    }
    .message.handover {
      background: rgba(255, 68, 68, 0.1);
      border-left: 3px solid #ff4444;
    }
    .ai-disclosure {
      background: rgba(255, 193, 7, 0.1);
      border: 1px solid #ffc107;
      color: #ffc107;
      padding: 0.5rem;
      border-radius: 0.5rem;
      font-size: 0.85rem;
      margin-bottom: 0.5rem;
      text-align: center;
    }
    .privacy-check {
      background: rgba(0, 255, 136, 0.05);
      border: 1px solid rgba(0, 255, 136, 0.3);
      border-radius: 0.5rem;
      padding: 0.75rem;
      font-size: 0.8rem;
      color: #00ff88;
      margin-top: 0.75rem;
    }
    .input-area {
      display: flex;
      gap: 0.5rem;
      padding: 1rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    input {
      flex: 1;
      padding: 0.75rem 1rem;
1px solid rgba      border: (255, 255, 255, 0.2);
      border-radius: 0.5rem;
      background: rgba(0, 0, 0, 0.3);
      color: #e0e0e0;
      font-size: 1rem;
    }
    input:focus {
      outline: none;
      border-color: #00ff88;
    }
    button {
      padding: 0.75rem 1.5rem;
      background: linear-gradient(90deg, #00ff88, #00d4ff);
      border: none;
      border-radius: 0.5rem;
      color: #0a0a0f;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.02);
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .typing {
      color: #00ff88;
      font-style: italic;
    }
    .api-key-input {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .api-key-input input {
      flex: 1;
    }
    .api-key-input button {
      white-space: nowrap;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Neon Clear</h1>
      <span class="badge">Intelligent Transparency Agent</span>
      <p style="margin-top: 1rem; color: #888;">Bridge of Trust for Neon Arcade</p>
    </header>

    <div class="setup-warning">
      <strong>Setup Required:</strong> Enter your Claude API key below to activate the agent
    </div>

    <div class="api-key-input" id="apiKeySetup">
      <input type="password" id="apiKey" placeholder="Enter your Anthropic API key (sk-ant-...)" />
      <button onclick="saveApiKey()">Save Key</button>
    </div>

    <div class="chat-container" id="chatContainer">
      <div class="messages" id="messages"></div>
      <div class="input-area">
        <input type="text" id="userInput" placeholder="Ask about data privacy, GDPR rights, or cloud performance..." />
        <button id="sendBtn" onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <script>
    const SYSTEM_PROMPT = `You are Neon Clear. Intelligent Transparency Agent for Neon Arcade.

Business Role: Acting as a "Bridge of Trust" for Neon Arcade.

Persona: Clinical but helpful, radically honest, and jargon-free.

Domain Expertise: Expert in GDPR Data Subject Rights (specifically the right to explanation) and Cloud Performance Metrics (latency/bandwidth).

CRITICAL RULES YOU MUST FOLLOW:
1. Disclose you are an AI immediately (EU AI Act Art. 50) at the start of EVERY interaction.
2. Explain the logic of ALL recommendations (e.g., 'I suggested this because your session latency is low and you enjoy RPGs').
3. Provide a 'Data Privacy' check at the end of EVERY interaction.
4. IMMEDIATELY trigger a human handover if the user mentions 'unauthorized charge' or 'privacy violation' - respond with: "[HUMAN HANDOVER REQUIRED] - A support agent will assist you shortly. For privacy violations, contact: privacy@neonarcade.com"

DATA PRIVACY CHECK (include at end of every response):
---
ðŸ”’ Data Privacy Check:
- This conversation is processed in compliance with GDPR
- Your data is not sold to third parties
- You can request data deletion at any time via privacy@neonarcade.com
- For GDPR data subject rights inquiries, visit: neonarcade.com/privacy
---

Remember: Radical transparency is your core value. Always be honest about limitations, costs, and data implications.`;

    const HANDOVER_TRIGGERS = ['unauthorized charge', 'privacy violation', 'data breach', 'illegal activity'];
    let apiKey = localStorage.getItem('neonclear_api_key') || '';
    let messages = [];

    function saveApiKey() {
      const input = document.getElementById('apiKey').value.trim();
      if (input) {
        apiKey = input;
        localStorage.setItem('neonclear_api_key', apiKey);
        document.getElementById('apiKeySetup').classList.add('hidden');
        document.getElementById('chatContainer').style.display = 'block';
      }
    }

    if (apiKey) {
      document.getElementById('apiKeySetup').classList.add('hidden');
    }

    const messagesDiv = document.getElementById('messages');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    function addMessage(content, role, isHandover = false) {
      const div = document.createElement('div');
      div.className = `message ${role}${isHandover ? ' handover' : ''}`;
      
      if (role === 'assistant') {
        const disclosure = document.createElement('div');
        disclosure.className = 'ai-disclosure';
        disclosure.textContent = 'ðŸ¤– AI Assistant - EU AI Act Art. 50 Compliant';
        div.appendChild(disclosure);
      }
      
      const contentDiv = document.createElement('div');
      contentDiv.innerHTML = content.replace(/\n/g, '<br>');
      div.appendChild(contentDiv);
      
      messagesDiv.appendChild(div);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message) return;

      if (!apiKey) {
        alert('Please enter your API key first!');
        return;
      }

      userInput.value = '';
      addMessage(message, 'user');
      
      sendBtn.disabled = true;
      addMessage('Thinking...', 'assistant');

      const shouldHandover = HANDOVER_TRIGGERS.some(trigger => 
        message.toLowerCase().includes(trigger.toLowerCase())
      );

      if (shouldHandover) {
        messagesDiv.removeChild(messagesDiv.lastChild);
        addMessage(`[HUMAN HANDOVER REQUIRED] - A support agent will assist you shortly. For privacy violations, contact: privacy@neonarcade.com

ðŸ”’ Data Privacy Check:
- This conversation is processed in compliance with GDPR
- Your data is not sold to third parties
- You can request data deletion at any time via privacy@neonarcade.com`, 'assistant', true);
        sendBtn.disabled = false;
        return;
      }

      try {
        const response = await fetch('https://api.anthropic.com/v1/messages', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': apiKey,
            'anthropic-version': '2023-06-01'
          },
          body: JSON.stringify({
            model: 'claude-3-5-sonnet-20241022',
            max_tokens: 1024,
            system: SYSTEM_PROMPT,
            messages: messages.concat([{ role: 'user', content: message }])
          })
        });

        const data = await response.json();
        
        messagesDiv.removeChild(messagesDiv.lastChild);
        
        if (data.content && data.content[0]) {
          const responseText = data.content[0].text;
          messages.push({ role: 'user', content: message });
          messages.push({ role: 'assistant', content: responseText });
          addMessage(responseText, 'assistant');
        } else if (data.error) {
          addMessage(`Error: ${data.error.message}`, 'assistant');
        } else {
          addMessage('Sorry, I encountered an error. Please try again.', 'assistant');
        }
      } catch (error) {
        messagesDiv.removeChild(messagesDiv.lastChild);
        addMessage('Sorry, I encountered an error. Please try again.', 'assistant');
      }

      sendBtn.disabled = false;
    }
  </script>
</body>
</html>
